PRD：ADHD 时间感知极简工具（桌面悬浮双态计时球）

1. 产品定位

1.1 一句话定位

一个常驻桌面的极简悬浮球，用绿/红两态帮助用户外化“专注/中断”，让时间切换可见、可统计，并提供3 秒回滚窗口降低误操作成本。

1.2 核心价值
	•	时间可见：把“我刚刚在干嘛、过了多久”变成可量化日志。
	•	切换低成本：无需打开 App，不打断工作流。
	•	降低误触焦虑：进入红色后 3 秒可回滚，避免一次误点污染数据与心态。
	•	复盘可行动：按日/周/月/年统计专注与中断模式，支持自我调整。

1.3 目标用户
	•	ADHD/时间感知困难人群（核心）
	•	学生/备考党（高频使用）
	•	知识工作者/远程办公、多任务切换者（泛用户）

1.4 设计原则
	•	极简第一：默认只做两态，不引入任务、清单、复杂番茄钟。
	•	无打扰：不推送、不弹窗（除了结束结算）。
	•	可信：事件流记录，支持崩溃恢复；跨天统计准确。
	•	低羞耻：红色语义为“Break/Reset（恢复/休息/中断）”，不是“失败”。

⸻

2. 产品全流程（用户旅程）

2.1 首次使用流程
	1.	用户启动 App
	2.	引导页（1 屏可跳过）：
	•	“绿色=Focus，红色=Break”
	•	“点球切换状态”
	•	“进入红色后 3 秒内可点一下回到绿色（防误触）”
	3.	用户点击「Start」
	4.	悬浮球出现（默认绿色）并开始计时
	5.	用户随时点击切换状态
	6.	用户长按结束 Session → 弹出结算页
	7.	用户进入后台查看当日/本周/本月/本年统计

2.2 日常使用流程（核心）
	•	开始：启动后自动显示悬浮球（可配置开机自启/启动即显示）
	•	记录：绿↔红切换
	•	防误触回滚：红色进入后 3 秒内允许一键回滚到绿
	•	结束结算：长按结束 → 结算页展示分段与汇总
	•	复盘：后台统计页查看趋势与关键指标

⸻

3. 信息架构（页面/模块）
	•	悬浮球（桌面常驻）
	•	结算页（Session Summary）
	•	统计页（Dashboard：日/周/月/年）
	•	设置页（极少项）

⸻

4. 功能需求（详细）

4.1 悬浮球（Floating Orb）

4.1.1 外观与交互
	•	常驻桌面、置顶显示（Always-on-top）
	•	可拖拽移动位置
	•	两态颜色：
	•	绿色：Focus
	•	红色：Break/Reset
	•	状态提示（极简）：
	•	默认只显示颜色
	•	在红色回滚倒计时期间，在球内显示小数字「3..1」（或细小进度表现）

4.1.2 交互手势定义（MVP 建议标准）
	•	单击
	•	绿色：切换到红色，并进入“红色回滚倒计时 3 秒”
	•	红色：
	•	若处于回滚倒计时中：回滚到绿色（不产生红色有效段，见 4.2）
	•	若不在倒计时中：切换到绿色（正常切换）
	•	长按（0.8s 可配置）：结束当前 Session，弹出结算页
	•	拖拽：移动位置（拖拽不触发点击切换，需有拖拽阈值）

4.1.3 悬浮球菜单（右键/小图标菜单，可选）
	•	Start/Show（当悬浮球隐藏时）
	•	End Session（同长按）
	•	Hide（隐藏悬浮球但不结束 Session，见 4.3）
	•	Open Dashboard
	•	Settings
	•	Quit

说明：如果你希望绝对极简，可把菜单压缩到 2 项：Dashboard、Settings，其他靠手势完成。

⸻

4.2 状态机与计时逻辑（核心）

4.2.1 状态定义
	•	GREEN：专注段计时中
	•	RED_PENDING：红色确认窗口（进入红色后 3 秒倒计时）
	•	RED：红色段计时中

4.2.2 切换规则（决定“可用性”的关键）

从绿到红：
	1.	用户在 GREEN 单击悬浮球
	2.	记录一次“进入红色待确认事件”（写入事件流）
	3.	状态进入 RED_PENDING，倒计时 3 秒开始
	4.	倒计时结束后：
	•	自动进入 RED，并记录“红色正式开始事件”
	•	红色段起点 = 倒计时结束时间（不是点击那一刻）

红色回滚（防误触）：
	•	在 RED_PENDING 期间，用户单击悬浮球：
	•	立即回到 GREEN
	•	该次红色尝试不计入红色有效时长
	•	事件流标记为“回滚取消”（用于调试与统计：误触率）

从红到绿：
	•	在 RED 期间，用户单击悬浮球：
	•	立即进入 GREEN
	•	红色段结束时间 = 点击时间
	•	绿色段起点 = 点击时间

4.2.3 计时段生成（Segment）

系统生成的段类型：
	•	Green Segment：[start_time, end_time) + duration
	•	Red Segment：[start_time, end_time) + duration
（注意：RED_PENDING 不生成有效 Red Segment）

4.2.4 验收标准
	•	RED_PENDING 被回滚时：红色有效时长为 0，不出现红色段
	•	RED_PENDING 到期确认后：红色段从确认时刻开始，且长度准确
	•	任何段不重叠、不出现负数时长

⸻

4.3 Session 生命周期与“关闭/隐藏”定义

你原始描述是“用户关闭小球后得到本次从开启到关闭的每个时间段”。这里需要明确两个动作：

4.3.1 End Session（结束并结算）

触发方式：长按悬浮球 / 菜单 End
行为：
	•	结束当前 Session
	•	弹出结算页（Session Summary）
	•	该 Session 写入历史，可在统计中聚合

4.3.2 Hide Orb（隐藏但不中断 Session）（建议保留）

触发方式：菜单 Hide / 快捷键
行为：
	•	悬浮球消失
	•	Session 不结束，但计时是否继续需要选择一个规则（MVP 建议：继续计时）
	•	用户再次 Show 时恢复悬浮球

如果你坚持“关闭=结算”，那就不要提供 Hide；但会降低可用性（例如会议投屏、录屏不想出现球时会痛苦）。

4.3.3 自动合并 Session（可选但推荐）

规则（默认开）：
	•	如果用户 End Session 后在 5 分钟内再次 Start：
	•	自动合并为同一个 Session（减少碎片）
	•	合并窗口可在设置中调整：0/5/10 分钟

⸻

4.4 结算页（Session Summary）

4.4.1 展示内容（必须）
	•	Session 概览
	•	开始时间、结束时间、总时长
	•	绿色总时长、红色总时长
	•	分段列表（按时间顺序）
	•	HH:MM - HH:MM | Green | 1h23m
	•	HH:MM - HH:MM | Red   | 08m
	•	关键指标（极简 1-2 个即可）
	•	平均绿色段时长（Avg Green Streak）
	•	最长绿色段时长（Max Green Streak，可选）

4.4.2 交互（建议）
	•	关闭：返回后台或直接关闭窗口
	•	导出（后置）：图片/文本摘要（用于分享）

4.4.3 验收标准
	•	结算页生成耗时 < 1 秒（本地）
	•	时间段计算正确，跨整点/跨天不出错

⸻

4.5 统计页（Dashboard：日/周/月/年）

4.5.1 核心指标（默认展示）
	•	Green Total（总专注）
	•	Red Total（总中断/休息）
	•	Avg Green Streak（平均连续专注时长）
	•	Max Green Streak（最长连续专注时长，可选）
	•	Session Count（当天 Session 数，可选）

4.5.2 维度与口径
	•	当日：按本地时区 00:00-24:00 归档
	•	本周：默认周一至周日（或遵循系统区域设置）
	•	本月：自然月
	•	本年：自然年

4.5.3 展示形式（保持极简）
	•	日：大数字卡片 + 简短列表（今天的 Session）
	•	周/月/年：仅汇总数字 + 简单趋势（可选一条折线：每天 Green 总时长）

如果你要更极简：趋势图也可后置，只给汇总与“最佳一天”。

⸻

4.6 设置（Settings，控制在 3-5 项）

建议项（MVP）：
	1.	红色回滚倒计时：固定 3 秒（可不开放配置，保持一致性）
	2.	自动合并窗口：0 / 5 / 10 分钟（默认 5）
	3.	启动行为：启动即显示悬浮球（默认开）
	4.	开机自启（默认关）
	5.	快捷键（可选，后置）

⸻

5. 数据模型与存储（保证统计可信）

5.1 事件流（Event Log）——推荐

用事件而不是直接存“段”，便于崩溃恢复与回滚判定。

Event 示例字段：
	•	id
	•	timestamp
	•	event_type
	•	SESSION_START
	•	ENTER_RED_PENDING
	•	CANCEL_RED_PENDING（回滚）
	•	CONFIRM_RED_START
	•	SWITCH_TO_GREEN
	•	SESSION_END
	•	session_id
	•	meta（如倒计时长度、触发方式、是否自动等）

段（Segment）可以在需要展示/统计时由事件计算得到，并缓存。

5.2 崩溃/重启恢复规则
	•	启动时检查是否存在“未结束 Session”
	•	若存在：恢复悬浮球与当前状态
	•	若停留在 RED_PENDING：
	•	若距离进入时间仍在 3 秒内：继续倒计时
	•	若已超过 3 秒：视为已确认进入 RED（补写确认事件）

⸻

6. 边界情况与规则（必须写清）
	1.	误触红色并立刻点回绿
	•	在 3 秒倒计时内 → 视为回滚，不记红段
	2.	用户进入红色倒计时，但什么都不做
	•	3 秒后自动变为红色正式计时
	3.	拖拽误触
	•	拖拽阈值：鼠标移动超过 X px 则判定为拖拽，不触发单击
	4.	跨天
	•	段跨天：按真实时间切分到两天统计中（例如 23:50-00:10 会拆成两段计入两天）
	5.	隐藏悬浮球（若支持）
	•	隐藏不影响计时；恢复显示后状态与计时连续
	6.	合并 Session
	•	合并只影响 Session 列表展示，不改变事件原始顺序与统计口径

⸻

7. 非功能需求（NFR）
	•	性能：常驻进程低 CPU、低内存；计时不依赖高频刷新
	•	稳定：事件写入必须 crash-safe（每次事件立即落盘）
	•	易用：所有核心操作≤1次点击或长按
	•	隐私：默认本地存储；不采集内容、不记录应用窗口标题（MVP 不做任何“监控类”能力）

⸻

8. 成功指标（MVP 验证）
	•	留存：D1 / D7（工具类关键）
	•	使用深度：日均切换次数、日均 Session 数
	•	行为改善信号：平均绿段时长是否随使用天数提升
	•	误触率：CANCEL_RED_PENDING / ENTER_RED_PENDING 比例（倒计时机制是否有效）

⸻

9. 版本计划（建议）
	•	v0.1（最小可用）：悬浮球 + 两态 + 红色 3 秒回滚倒计时 + 结算页 + 当日统计
	•	v0.2（留存提升）：自动合并 Session + 周/月统计 + 崩溃恢复完善
	•	v0.3（增长）：周报卡片导出（可分享）+ 快捷键

